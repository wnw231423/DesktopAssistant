<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:GUI.ViewModels"
             xmlns:views="using:GUI.Views"
             mc:Ignorable="d" d:DesignWidth="600" d:DesignHeight="700"
             x:Class="GUI.Views.CourseCardView"
             x:DataType="vm:CourseCardViewModel">

    <Grid RowDefinitions="Auto,*">
        <!-- 课程基本信息卡片 -->
        <Border Grid.Row="0" 
                BorderThickness="1" 
                BorderBrush="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                CornerRadius="8" 
                Padding="20" 
                Margin="0,0,0,15"
                Background="{DynamicResource SystemControlBackgroundAltHighBrush}">
            <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto" ColumnDefinitions="150,*">
                <!-- 标题 -->
                <TextBlock Grid.Row="0" Grid.ColumnSpan="2"
                           Text="课程信息"
                           FontSize="20" 
                           FontWeight="Bold"
                           Margin="0,0,0,15"/>
                
                <!-- 课程名称 -->
                <TextBlock Grid.Row="1" Grid.Column="0"
                           Text="课程名称："
                           VerticalAlignment="Center"
                           Margin="0,5"/>
                <TextBox Grid.Row="1" Grid.Column="1"
                         Text="{Binding Course.CourseName}"
                         Margin="0,5"
                         IsReadOnly="{Binding !IsEditing}"/>
                
                <!-- 周次范围 -->
                <TextBlock Grid.Row="2" Grid.Column="0"
                           Text="周次范围："
                           VerticalAlignment="Center"
                           Margin="0,5"/>
                <TextBox Grid.Row="2" Grid.Column="1"
                         Text="{Binding Course.WeekRange}"
                         Margin="0,5"
                         IsReadOnly="{Binding !IsEditing}"/>
                
                <!-- 星期和时间 -->
                <TextBlock Grid.Row="3" Grid.Column="0"
                           Text="上课时间："
                           VerticalAlignment="Center"
                           Margin="0,5"/>
                <Grid Grid.Row="3" Grid.Column="1" ColumnDefinitions="*,Auto,Auto,Auto,Auto">
                    <ComboBox Grid.Column="0"
                              ItemsSource="{Binding WeekdayOptions}"
                              SelectedItem="{Binding Course.Weekday}"
                              IsEnabled="{Binding IsEditing}"
                              Margin="0,5,5,5"/>
                    <TextBlock Grid.Column="1" 
                               Text="第" 
                               VerticalAlignment="Center"
                               Margin="5,0"/>
                    <NumericUpDown Grid.Column="2"
                                  Value="{Binding Course.StartSlot}"
                                  Minimum="1"
                                  Maximum="12"
                                  IsEnabled="{Binding IsEditing}"
                                  Width="70"/>
                    <TextBlock Grid.Column="3" 
                               Text="-" 
                               VerticalAlignment="Center"
                               Margin="5,0"/>
                    <NumericUpDown Grid.Column="4"
                                  Value="{Binding Course.EndSlot}"
                                  Minimum="1"
                                  Maximum="12"
                                  IsEnabled="{Binding IsEditing}"
                                  Width="70"/>
                </Grid>
                
                <!-- 教室 -->
                <TextBlock Grid.Row="4" Grid.Column="0"
                           Text="教室："
                           VerticalAlignment="Center"
                           Margin="0,5"/>
                <TextBox Grid.Row="4" Grid.Column="1"
                         Text="{Binding Course.Classroom}"
                         Margin="0,5"
                         IsReadOnly="{Binding !IsEditing}"/>
                
                <!-- 教师 -->
                <TextBlock Grid.Row="5" Grid.Column="0"
                           Text="授课教师："
                           VerticalAlignment="Center"
                           Margin="0,5"/>
                <TextBox Grid.Row="5" Grid.Column="1"
                         Text="{Binding Course.Teacher}"
                         Margin="0,5"
                         IsReadOnly="{Binding !IsEditing}"/>
            </Grid>
        </Border>
        
        <!-- 操作按钮 -->
        <StackPanel Grid.Row="0" 
                   Orientation="Horizontal" 
                   HorizontalAlignment="Right" 
                   VerticalAlignment="Bottom"
                   Margin="0,0,20,0">
            <Button Content="{Binding EditButtonText}"
                    Command="{Binding ToggleEditModeCommand}"
                    Margin="5"/>
            <Button Content="保存"
                    Command="{Binding SaveChangesCommand}"
                    IsVisible="{Binding IsEditing}"
                    Margin="5"/>
            <Button Content="取消"
                    Command="{Binding CancelEditingCommand}"
                    IsVisible="{Binding IsEditing}"
                    Margin="5"/>
        </StackPanel>
        
        <!-- 课程资源 -->
        <views:ResourcesView Grid.Row="1" 
                            DataContext="{Binding ResourcesViewModel}"
                            Margin="0,10,0,0"/>
    </Grid>
</UserControl>