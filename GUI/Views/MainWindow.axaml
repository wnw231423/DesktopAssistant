<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:GUI.ViewModels"
        xmlns:views="using:GUI.Views"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
        x:Class="GUI.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="æ­¦å¤§è¯¾è¡¨åŠ©æ‰‹"
        TransparencyLevelHint="AcrylicBlur"
        Background="Transparent"
        ExtendClientAreaToDecorationsHint="True"
        ExtendClientAreaTitleBarHeightHint="32">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Window.Styles>
        <!-- ä¾§è¾¹å¯¼èˆªæŒ‰é’®æ ·å¼ -->
        <Style Selector="Button.NavButton">
            <Setter Property="Width" Value="48"/>
            <Setter Property="Height" Value="48"/>
            <Setter Property="Margin" Value="0,4"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="22"/>
            <Setter Property="Foreground" Value="{DynamicResource PrimaryForegroundBrush}"/>
        </Style>
        
        <Style Selector="Button.NavButton:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource SecondaryBackgroundBrush}"/>
        </Style>
        
        <Style Selector="Button.NavButton:pressed /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource CardBackgroundBrush}"/>
        </Style>
        
        <Style Selector="Button.NavButton[IsEnabled=True][Tag=Selected]">
            <Setter Property="Background" Value="{DynamicResource CardBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource PrimaryAccentBrush}"/>
        </Style>
        
        <!-- ä¸»é¢˜åˆ‡æ¢æŒ‰é’®æ ·å¼ -->
        <Style Selector="Button.ThemeButton">
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="CornerRadius" Value="20"/>
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="Foreground" Value="{DynamicResource PrimaryForegroundBrush}"/>
        </Style>
        
        <Style Selector="Button.ThemeButton:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource SecondaryBackgroundBrush}"/>
        </Style>
    </Window.Styles>

    <Border Background="{DynamicResource PrimaryBackgroundBrush}"
            CornerRadius="12" Margin="8">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="64"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- æ ‡é¢˜æ  -->
            <Border Grid.ColumnSpan="2"
                    Name="TitleBarHost"
                    Background="{DynamicResource PrimaryBackgroundBrush}"
                    Height="32" VerticalAlignment="Top"
                    IsHitTestVisible="False"
                    Opacity="0.8"/>

            <!-- ä¾§è¾¹å¯¼èˆªæ  -->
            <Border Background="{DynamicResource SecondaryBackgroundBrush}"
                    CornerRadius="10,0,0,10" Margin="4,4,0,4">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- åº”ç”¨Logo -->
                    <TextBlock Text="æ­¦"
                               FontSize="24" FontWeight="Bold"
                               Foreground="{DynamicResource PrimaryAccentBrush}"
                               HorizontalAlignment="Center"
                               Margin="0,16,0,24"/>

                    <!-- å¯¼èˆªæŒ‰é’® -->
                    <StackPanel Grid.Row="1">
                        <Button Classes="NavButton"
                                Tag="{Binding SelectedPageTag, Converter={StaticResource EqualityConverter}, ConverterParameter=Table}"
                                Command="{Binding NavigateCommand}"
                                CommandParameter="Table">
                            <TextBlock Text="ðŸ“š"/>
                            <ToolTip.Tip>è¯¾ç¨‹è¡¨</ToolTip.Tip>
                        </Button>
                        
                        <Button Classes="NavButton"
                                Tag="{Binding SelectedPageTag, Converter={StaticResource EqualityConverter}, ConverterParameter=Todo}"
                                Command="{Binding NavigateCommand}"
                                CommandParameter="Todo">
                            <TextBlock Text="âœ“"/>
                            <ToolTip.Tip>å¾…åŠžäº‹é¡¹</ToolTip.Tip>
                        </Button>
                        
                        <Button Classes="NavButton"
                                Tag="{Binding SelectedPageTag, Converter={StaticResource EqualityConverter}, ConverterParameter=Settings}"
                                Command="{Binding NavigateCommand}"
                                CommandParameter="Settings">
                            <TextBlock Text="âš™"/>
                            <ToolTip.Tip>è®¾ç½®</ToolTip.Tip>
                        </Button>
                    </StackPanel>

                    <!-- ä¸»é¢˜åˆ‡æ¢æŒ‰é’® -->
                    <Button Grid.Row="2"
                            Classes="ThemeButton"
                            Command="{Binding ToggleThemeCommand}"
                            HorizontalAlignment="Center"
                            Margin="0,0,0,16">
                        <Panel>
                            <TextBlock Text="ðŸŒ™" IsVisible="{Binding !IsDarkTheme}"/>
                            <TextBlock Text="â˜€" IsVisible="{Binding IsDarkTheme}"/>
                        </Panel>
                        <ToolTip.Tip>
                            <TextBlock Text="{Binding IsDarkTheme, Converter={StaticResource ThemeTextConverter}}"/>
                        </ToolTip.Tip>
                    </Button>
                </Grid>
            </Border>

            <!-- å†…å®¹åŒº -->
            <Border Grid.Column="1"
                    Background="{DynamicResource PrimaryBackgroundBrush}"
                    Margin="0,4,4,4"
                    CornerRadius="0,10,10,0">
                <!-- å†…å®¹è½¬æ¢å™¨ -->
                <ContentControl Content="{Binding CurrentView}"/>
            </Border>
        </Grid>
    </Border>
</Window>